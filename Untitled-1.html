<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>魔術方陣</title>
<script>

    var Ans = document.getElementById("Ans");
    var input = Ans.getElementsByTagName('input')[0];
    let button = Ans.getElementsByTagName('button')[0];
    let show = Ans.getElementsByTagName('div')[0];
    //let n= prompt("請輸入魔術方陣");
    let n=input.value;
    let magic=[];

    button.onclick=function go() {
        show.innerHTML = "";
        let table = document.createElement('table');
        table.setAttribute('border', '1');
        table.setAttribute('cellspacing', '0');

        let tbody = document.createElement('tbody');
        for (let i = 0; i < n; i++) {
            let tr = document.createElement('tr');
            magic[i] = [];
            for (let j = 0; j < n; j++) {
                let td = document.createElement('td');
                magic[i][j] = td;
                tr.appendChild(td);
            }
            tbody.appendChild(tr);
        }
        table.appendChild(tbody);
        show.appendChild(table);

        let R = 0;
        let C = 0;
        let t = 1;
        let tx, ty;

        function start() {
            if (v == 1) {
                R = Math.floor(n / 2);
                C = 0;
            } else {
                R = (R - 1) < 0 ? n - 1 : R - 1;
                C = (C - 1) < 0 ? n - 1 : C - 1;
                if (parseInt(magic[C][R].innerHTML) > 0) {
                    R = tx;
                    C = ty;
                    C = (C + 1) > n - 1 ? 0 : C + 1;
                }
            }
            tx = R;
            ty = C;
            magic[C][R].innerHTML = t;
            t += 1;
            if (t > (n * n)) {
                return false;
            }
        }
    }

        /*var row=0;
        let col=n/2;
        //document.write(n);
        magic[row][col]=1; //將1放入第1列中間位置
        
        for(let i=2;i<=n*n;i++){
            row=(row-1+n)%n;
            col=(col-1+n)%n;
            if(magic[row][col]!==0){ //要放的位置上已經有數值
                row = (row + 2) % n;
                col = (col + 1) % n;
            }
            magic[row][col]=i; //將i放入決定好的位置

            //return i;
        }
        for(let R=0;R<n;R++){
            for(let C=0;C<n;C++){
                //return R,C;
                document.write(magic[0][n-1],magic[R][C]) ;
            }
            document.write();
        }
    }*/
    go();
    start();


</script>
</head>
<body>
    <div id="Ans">
        <p>請輸入魔術方陣 <input type="number" width="60px"/>
            <button>start</button>
        </p>
        <div></div>
    </div>
</body>
</html>