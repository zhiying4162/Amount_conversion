<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>魔法陣(奇数)</title>
  </head>
  <body>
    <h1>&#x2618;魔法陣(奇数)</h1>
    <p>
    Input Number => <input type="text"></input>
    </p>
    <table id='magic' border="1" cellspacing="0" cellpadding="5">
      <tbody>
      </tbody>
    </table>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous">
    </script>
    <script>
    function solv(arr) {
        var n = arr.length - 1;
        var x = (n + 1) / 2;
        var y = 1;
        arr[y][x] = 1;
        for (let i = 2; i <= n*n; i++) {
            if (i % n == 1) {   // 右上に数字がすでにあれば、すぐ下に
                y++;
            }
            else {
                x++;
                y--;
                if (y <= 0) {   // 上方向に突き抜けたら、一番下へ
                    y = n;
                }
                else if (x > n) { // 右方向へ突き抜けたら、一番左へ
                    x = 1;
                }
            }
            arr[y][x] = i;
        }
    }

    $(function() {
        $("input").keypress(function(e) {
            if (e.which == 13) {
                var n = parseInt($("input").val(), 10);
                var arr = new Array(n+1);
                for (let i = 0; i < n+1; i++) {
                    arr[i] = new Array(n+1);
                }
                solv(arr);
                var el = $('#magic > tbody');
                el.empty();
                for (let i = 1; i <= n; i++) {
                    var tr = $('<tr>');
                    for (let j = 1; j <= n; j++) {
                        var td = $('<td>').text(arr[i][j]);
                        td.attr('align', 'center');
                        tr.append(td);
                    }
                    el.append(tr);
                }
                return false;
            }
        });
    });
  </script>
  </body>
</html>